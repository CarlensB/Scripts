# ==========================================================================# Prénom Nom: Carlens Belony# Date de création: 07 novembre 2022# # But: Création des unités d'organisation et des groupes#      du domaine ETU1826732.LOCAL# # Ce script doit s’exécuter à partir du SERVEUR2.# ==========================================================================Clear-Host#-----------------------------------------------------------------------------$OU="OU=INFORMATIQUE,DC=ETU1826732,DC=local"$resultat = $(try {Get-ADOrganizationalUnit -Identity $OU} catch {$null})$Compte = 0if ($resultat -ne $null){   Set-ADOrganizationalUnit -Identity $OU `                           -ProtectedFromAccidentalDeletion $false  Remove-ADOrganizationalUnit -Identity $OU `                              -Recursive ` `                              -Confirm:$false}  New-ADOrganizationalUnit `    -Name "INFORMATIQUE" `    -Path "DC=ETU1826732,DC=local" `    -ProtectedFromAccidentalDeletion $false    $Compte++#-----------------------------------------------------------------------------#Création des UO principaux et des groupes EMPLOYES et GESTIONNAIRES$noms = "UTILISATEURS","GROUPES","ORDINATEURS"$nomsGroupes = "EMPLOYES","GESTIONNAIRES"$cheminGroupes = "OU=GROUPES,$OU"$CompteGroupes = 0# Lire le contenu du tableau une valeur à la foisforeach ($nom in $noms){    New-ADOrganizationalUnit `        -Name $Nom `        -Path $OU `        -ProtectedFromAccidentalDeletion $true    $Compte++}foreach ($nomGr in $nomsGroupes){    New-ADGroup -Name $nomGr `                    -GroupCategory "Security" `                    -GroupScope "Global" `                    -Description "Groupe de tous les $nomGr de l'UO" `                    -Path $cheminGroupes                    $CompteGroupes++}#-----------------------------------------------------------------------------# Création des UO sous Utilisateurs# Création des groupes EMPLOYES et GESTIONNAIRES respectifs$noms = "CONCEPTEURS_WEB","PROGRAMMEURS_ANDROID","PROGRAMMEURS_Python", `         "TECHNICIENS_RESEAU", "TESTEURS_LOGICIELS_ANDROID", `         "TESTEURS_LOGICIELS_PYTHON"$sous_categories = "Employes", "Gestionnaires"foreach ($nom in $noms){    New-ADOrganizationalUnit `        -Name $Nom `        -Path $OU `        -ProtectedFromAccidentalDeletion $false        foreach ($categories in $sous_categories)            {                New-ADOrganizationalUnit `                    -Name $categories `                    -Path "OU=$nom,$OU" `                    -ProtectedFromAccidentalDeletion $true                               $Compte++                New-ADGroup -Name Gr$($nom)_$($categories) `                -GroupCategory "Security" `                -Description "Groupe des $categories de l'UO $nom" `                -GroupScope "Global" `                -Path $cheminGroupes                $CompteGroupes++            }    $Compte++}Get-ADOrganizationalUnit -SearchBase $OU `          -Filter * -Properties CanonicalName | Sort-Object CanonicalName | Format-Table CanonicalNameWrite-Host "$Compte UO ont été créés." -ForegroundColor GreenGet-ADGroup -Properties CanonicalName -SearchBase $OU `          -Filter * | Sort-Object CanonicalName | Format-Table CanonicalNameWrite-Host "$CompteGroupes Groupes ont été créés." -ForegroundColor Green